<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"
        integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <link rel="stylesheet" href="./lib/leaflet-measure.css">
    <!-- for search button -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />
    <!-- Include Leaflet Geolocate CSS -->
    <link href="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol@0.81.1/dist/L.Control.Locate.min.css"
        rel="stylesheet">

    <!-- Include Leaflet Draw CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/0.4.2/leaflet.draw.css" />
    <style>
        html,
        body,
        #map {
            width: 100%;
            height: 100%;
            margin: 0px;
            padding: 0px;
        }
    </style>
    <!-- Add styling for legend -->
    <style>
        .info {
            padding: 6px 8px;
            font: 14px/16px Arial, Helvetica, sans-serif;
            background: white;
            background: rgba(255, 255, 255, 0.8);
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
            border-radius: 5px;
        }

        .legend i {
            width: 18px;
            height: 18px;
            float: left;
            margin-right: 8px;
            opacity: 0.7;
        }
    </style>
    <title>WEBGIS Projects</title>

</head>

<body>

    <!-- nav bar -->
    <!-- <nav class="navbar navbar-expand-lg dark-body-info">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">Basic Web-GIS</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="#">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Upload data</a>
                    </li>
            </div>
        </div>
    </nav> -->
    <!-- Include Leaflet Draw JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/0.4.2/leaflet.draw.js"></script>
    <!-- Include Leaflet Geolocate JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol@0.81.1/dist/L.Control.Locate.min.js"></script>
    <!-- add geojson -->
    <script src="./data/data.js"></script>
    <div id="map"></div>
    <!-- to add a print layout -->
    <script src="./lib/leaflet.browser.print.min.js"></script>
    <!-- for measure tools -->
    <script src="./lib/leaflet-measure.js"></script>
    <!-- for search button -->
    <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
    <!-- for leaflet control layers -->
    <script>
        var map = L.map('map').setView([30.637912, 70.708008], 5);

        //add layer tile
        var osm = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
        }).addTo(map);
        var Esri = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
            attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community'
        });
        var CartoDB_Positron = L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
            subdomains: 'abcd',
            maxZoom: 20
        });

        // Popup on every click 
        var popup = L.popup();

        function onMapClick(e) {
            popup
                .setLatLng(e.latlng)
                .setContent("You clicked the map at " + e.latlng.toString())
                .openOn(map);
        }

        map.on('click', onMapClick);
        //add a north arrow
        var northArrow = L.control({ position: 'topright' });
        northArrow.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'leaflet-bar leaflet-control leaflet-control-custom');
            div.innerHTML = '<img src="/images/north-arrow.png" alt="North Arrow" style="width:24px;height:24px;display:block;margin:auto;" />';
            div.style.backgroundColor = 'white';
            div.style.width = '30px';
            div.style.height = '30px';
            return div;
        };
        northArrow.addTo(map);
        //add a layer control button
        var baseLayers = {
            "OSM": osm,
            "Esri": Esri,
            "CartoDB_Positron": CartoDB_Positron
        };
        L.control.layers(baseLayers).addTo(map);


        // to add print layout button 
        L.control.browserPrint({ position: 'topright' }).addTo(map);
        //add a search button
        L.Control.geocoder().addTo(map);
        //add a measure button
        var measureControl = L.control.measure({
            primaryLengthUnit: 'kilometers',
            secondaryLengthUnit: 'miles',
            primaryAreaUnit: 'acres',
            secondaryAreaUnit: 'sqmeters',
            activeColor: '#ABE67E',
            completedColor: '#C8F2BE'
        }).addTo(map);
        // adding geojson
        var json = {
            "type": "FeatureCollection",
            "features": [
                {
                    "type": "Feature",
                    "properties": {
                        "Name": "Islamabad"
                    },
                    "geometry": {
                        "coordinates": [
                            73.04774296675589,
                            33.68651994896835
                        ],
                        "type": "Point"
                    },
                    "id": 0
                },
                {
                    "type": "Feature",
                    "properties": {
                        "Name ": "Lahore"
                    },
                    "geometry": {
                        "coordinates": [
                            74.3101797573189,
                            31.608826770227964
                        ],
                        "type": "Point"
                    },
                    "id": 1
                },
                {
                    "type": "Feature",
                    "properties": {
                        "Name": "Quetta"
                    },
                    "geometry": {
                        "coordinates": [
                            66.94067002427778,
                            30.11942321051501
                        ],
                        "type": "Point"
                    },
                    "id": 2
                },
                {
                    "type": "Feature",
                    "properties": {
                        "Name ": "Multan"
                    },
                    "geometry": {
                        "coordinates": [
                            71.43507940994971,
                            30.14962252664509
                        ],
                        "type": "Point"
                    },
                    "id": 3
                },
                {
                    "type": "Feature",
                    "properties": {
                        "Name": "ISlamabad"
                    },
                    "geometry": {
                        "coordinates": [
                            68.38214534660204,
                            25.35514009469503
                        ],
                        "type": "Point"
                    },
                    "id": 4
                }
            ]
        }
        L.geoJSON(geojson).addTo(map);
        //add a popup on geojson
        L.geoJSON(geojson, {
            style: function (feature) {
                return {
                    color: 'blue',
                    weight: 2,
                    opacity: 1,
                    fillColor: 'yellow',
                    fillOpacity: 0.5
                };
            },

            onEachFeature: function (feature, layer) {
                layer.bindPopup(feature.properties.NAME_3);
            }
        }).addTo(map);
        //add a geolocate button
        var locateControl = L.control.locate({
            position: 'topright',
            drawCircle: true,
            follow: false,
            setView: true,
            keepCurrentZoomLevel: false,
            markerStyle: {
                weight: 1,
                opacity: 1,
                fillOpacity: 0.8
            },
            circleStyle: {
                weight: 1,
                clickable: false
            },
            icon: 'fa fa-map-marker',
            iconLoading: 'fa fa-spinner fa-spin',
            metric: true, // for metric/imperial units
            strings: {
                title: "Show me where I am",
                popup: "You are within {distance} {unit} from this point",
                outsideMapBoundsMsg: "You seem located outside the boundaries of the map"
            }
        }).addTo(map);
        //add a draw button
        var drawnItems = new L.FeatureGroup();
        map.addLayer(drawnItems);
        var drawControl = new L.Control.Draw({
            edit: {
                featureGroup: drawnItems
            }
        });
        map.addControl(drawControl);
        map.on('draw:created', function (e) {
            var type = e.layerType,
                layer = e.layer;

            if (type === 'marker') {
                layer.bindPopup('A popup!');
            }

            drawnItems.addLayer(layer);
        });
        //add a legend
        var legend = L.control({ position: 'bottomleft' });
        legend.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'info legend'),
                grades = [0, 1, 2, 3, 4],
                labels = [];

            // loop through our density intervals and generate a label with a colored square for each interval
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<i style="background:' + getColor(grades[i] + 1) + '"></i> ' +
                    grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] + '<br>' : '+');
            }

            return div;
        };
        legend.addTo(map);
        function getColor(d) {
            return d > 4 ? '#800026' :
                d > 3 ? '#BD0026' :
                    d > 2 ? '#E31A1C' :
                        d > 1 ? '#FC4E2A' :
                            d > 0 ? '#FD8D3C' :
                                '#FFEDA0';
        }

    </script>



</body>

</html>